<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
    <link href="css/style3.css" rel="stylesheet" type="text/css" />
    <!-- 拍照按钮-->
	<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel="stylesheet" href="css/style4.css">
    
    <!-- -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/modal_dialog.js"></script>
    
	<!-- 覆盖窗口-->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style5.css"> <!-- Resource style -->
	<script src="js/modernizr.js"></script> <!-- Modernizr -->
	<script src="js/jquery-2.1.1.js"></script>
	<script src="js/velocity.min.js"></script>
	<script src="js/main.js"></script> <!-- Resource jQuery -->
<style>

.body2 {
  overflow: hidden;  height:100%;
  width:100%;
  background: #262b2e
}

#wrapper {
  height:100%;
  width:100%;
  text-align: center;
  display: table;
  position:absolute;
}

#title {
  display: table-cell;
  vertical-align: middle;
  z-index: 999;
}

#title h2 {
  color: #fff;
  font-size: 45px;
  font-family: "museo-slab";
}

#title h3 {
  color: #fff;
  font-size: 25px;
  font-family: "museo-sans";
  font-weight: 300
}


#wrapper canvas {
  position: absolute;
  top: 0;
  left: 0;

  width:100%;
}

#canvas {
  z-index: 1;
}
#canvasbg {
  z-index: -10;
  -webkit-filter: blur(3px);
  -moz-filter: blur(3px);
  -o-filter: blur(3px);
  filter: blur(3px);
  opacity: 0.6;
}</style>

</head>
<body>


    <section class="aui-flexView cd-section">
        <section class="aui-scrollView">
            <div class="aui-head-body">
                <i class="icon icon-news"></i>
                <img src="images/head2.png" alt="">
                <div class="aui-user-item">
                    <div class="aui-mine-user">
                        <img src="images/user-logo-002.png" alt="">
                    </div>
                    <div class="aui-mine-name">
                        <h2>圆通<i class="icon icon-edit"></i></h2>
                    </div>
                </div>
            </div>
            <div class="aui-palace">  
                <a href="javascript:;" class="aui-palace-grid">
                    <div class="aui-palace-grid-icon">
                        <img src="images/icon-head-002.png" alt="">
                    </div>
                    <div class="aui-palace-grid-text">
                        <h2>邀请好友</h2>
                    </div>
                </a>
              
                <a href="javascript:;" class="aui-palace-grid">
                    <div class="aui-palace-grid-icon">
                        <img src="images/icon-head-004.png" alt="">
                    </div>
                    <div class="aui-palace-grid-text">
                        <h2>联系客服</h2>
                    </div>
                </a>
                <a href="javascript:;" class="aui-palace-grid">
                    <div class="aui-palace-grid-icon">
                        <img src="images/icon-head-005.png" alt="">
                    </div>
                    <div class="aui-palace-grid-text">
                        <h2>评价</h2>
                    </div>
                </a>
                
            </div>
            <div class="aui-landlady cd-modal-action"  style="background:#34383c;border:none;height:130px">
                 <button class="corner-button message btn" style="position:relative;z-index:50;margin:auto;top:10px" data-icon="success" data-type="modal-trigger" id="mes1">
					<span>拍照上传</span>
				 </button>
				 <span class="cd-modal-bg" style="z-index:50"></span>
            </div>
           <div class="cd-modal" style="z-index:50">
			<div class="cd-modal-content" >
				<bodyclass="body2">
					<div id="wrapper">
   					 <canvas id="canvas" width="1950px" height="800px"></canvas>
  					 <canvas id="canvasbg" width="1950px" height="800px"></canvas>
					</div>
				</body>
				</div> <!-- cd-modal-content -->
			</div> <!-- cd-modal -->
			
            <div class="aui-landlady">
                <a href="javascript:;" class="aui-flex">
                    <div class="aui-flex-box">
                        <h3>向朋友推荐</h3>
                    </div>
                    <div class="aui-arrow">
                        <p></p>
                    </div>
                </a>
                <a href="javascript:;" class="aui-flex">
                    <div class="aui-flex-box">
                        <h3>意见反馈</h3>
                    </div>
                    <div class="aui-arrow">
                        <p></p>
                    </div>
                </a>
                <a href="javascript:;" class="aui-flex">
                    <div class="aui-flex-box">
                        <h3>喜欢我们，打分鼓励一下</h3>
                    </div>
                    <div class="aui-arrow">
                        <p></p>
                    </div>
                </a>
                <a href="javascript:;" class="aui-flex">
                    <div class="aui-flex-box">
                        <h3>关于我们</h3>
                    </div>
                    <div class="aui-arrow">
                        <p></p>
                    </div>
                </a>
            </div>
            <div style="height:5rem"></div>
        </section>
        <footer class="aui-footer aui-footer-fixed" style="z-index:50">
 
            <a href="javascript:;" class="aui-tabBar-item ">
                <span class="aui-tabBar-item-icon">
                    <i class="icon icon-credit"></i>
                </span>
                <span class="aui-tabBar-item-text">消息</span>
            </a>
           
            <a href="javascript:;" class="aui-tabBar-item aui-tabBar-item-active">
                <span class="aui-tabBar-item-icon">
                    <i class="icon icon-my"></i>
                </span>
                <span class="aui-tabBar-item-text">我的</span>
            </a>

        </footer>
    </section>

</body>
<script src="http://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
<script src="js/jquery-3.4.1.min.js" type="text/javascript"></script>

<script>
function message(e) {
    $modal({
        type: 'message', //弹框类型  'alert' or  'confirm' or 'message'  message提示(开启之前如果之前含有弹框则清除)
        icon: e, // 提示图标显示 'info' or 'success' or 'warning' or 'error'  or 'question'
        timeout: 2000, // 单位 ms  显示多少毫秒后关闭弹框 （ confirm 下无效 | 不传默认为 2000ms | 最短显示时间为500ms）
        content: '人间值得', // 提示文字
        center: false,// 是否绝对居中 默认为false  设置true后   top无效
        top: 100, //距离顶部距离 单位px
        transition: 300, //过渡动画 默认 200   单位ms
        closable: true, // 是否显示可关闭按钮  默认为 false
    })
}

$('.message').click(function () {
	var a=0;
		$.ajax({
	    	type:"get",
	    	url:"http://jc02.free.idcfengye.com/a1/upload",
	    	dataType:"json",
	    	success: function(par){
	    		wx.config({
	  			  debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
	  			  appId: par.appId, // 必填，公众号的唯一标识
	  			  timestamp: par.timestamp, // 必填，生成签名的时间戳
	  			  nonceStr: par.nonceStr, // 必填，生成签名的随机串
	  			  signature: par.signature,// 必填，签名
	  			  jsApiList: ['chooseImage','uploadImage'] // 必填，需要使用的JS接口列表
	  			});
	  		wx.ready(function(){
	  			  // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。

	  			  wx.chooseImage({
	  				  count: 1, // 默认9
	  				  sizeType: ['compressed'], // 可以指定是原图还是压缩图，默认二者都有
	  				  sourceType: ['camera'], // 可以指定来源是相册还是相机，默认二者都有
	  				  success: function (res) {
	  				  var localIds = res.localIds; // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片
	  				  $("img").attr('src',localIds);
	  				 
	  				  wx.uploadImage({
	  					  localId: localIds.toString(), // 需要上传的图片的本地ID，由chooseImage接口获得
	  					  isShowProgressTips: 1, // 默认为1，显示进度提示
	  					  success: function (res){
	  					    var serverId = res.serverId; // 返回图片的服务器端ID
	  					    $("h1").html(serverId);
	  					    $.ajax({
	  					    	type:"get",
	  					    	url:"http://jc02.free.idcfengye.com/a1/uploadImg?media_id="+serverId.toString(),
	  					    	success: function (c){
	  					    		message($("#mes1").attr('data-icon'));
	  					    		setTimeout(function () {
	  					    			window.location.href=window.location.href;	 
	  			                    }, 500);
	  								   		 
	  					    	}
	  					  })
	  					  }
	  					});
	  				  }
	  				});  
	  		});
	    	}
	    });
		
	})
	</script>
	<script>
// min and max radius, radius threshold and percentage of filled circles
var radMin = 5,
  radMax = 125,
  filledCircle = 60, //percentage of filled circles
  concentricCircle = 30, //percentage of concentric circles
  radThreshold = 25; //IFF special, over this radius concentric, otherwise filled

//min and max speed to move
var speedMin = 0.3,
  speedMax = 2.5;

//max reachable opacity for every circle and blur effect
var maxOpacity = 0.6;

//default palette choice
var colors = ['52,168,83', '117,95,147', '199,108,23', '194,62,55', '0,172,212', '120,120,120'],
  bgColors = ['52,168,83', '117,95,147', '199,108,23', '194,62,55', '0,172,212', '120,120,120'],
  circleBorder = 10,
  backgroundLine = bgColors[0];
var backgroundMlt = 0.85;

//min distance for links
var linkDist = Math.min(canvas.width, canvas.height) / 2.4,
  lineBorder = 2.5;

//most importantly: number of overall circles and arrays containing them
var maxCircles = 12,
  points = [],
  pointsBack = [];

//populating the screen
for (var i = 0; i < maxCircles * 2; i++) points.push(new Circle());
for (var i = 0; i < maxCircles; i++) pointsBack.push(new Circle(true));

//experimental vars
var circleExp = 1,
  circleExpMax = 1.003,
  circleExpMin = 0.997,
  circleExpSp = 0.00004,
  circlePulse = false;

//circle class
function Circle(background) {
  //if background, it has different rules
  this.background = (background || false);
  this.x = randRange(-canvas.width / 2, canvas.width / 2);
  this.y = randRange(-canvas.height / 2, canvas.height / 2);
  this.radius = background ? hyperRange(radMin, radMax) * backgroundMlt : hyperRange(radMin, radMax);
  this.filled = this.radius < radThreshold ? (randint(0, 100) > filledCircle ? false : 'full') : (randint(0, 100) > concentricCircle ? false : 'concentric');
  this.color = background ? bgColors[randint(0, bgColors.length - 1)] : colors[randint(0, colors.length - 1)];
  this.borderColor = background ? bgColors[randint(0, bgColors.length - 1)] : colors[randint(0, colors.length - 1)];
  this.opacity = 0.05;
  this.speed = (background ? randRange(speedMin, speedMax) / backgroundMlt : randRange(speedMin, speedMax)); // * (radMin / this.radius);
  this.speedAngle = Math.random() * 2 * Math.PI;
  this.speedx = Math.cos(this.speedAngle) * this.speed;
  this.speedy = Math.sin(this.speedAngle) * this.speed;
  var spacex = Math.abs((this.x - (this.speedx < 0 ? -1 : 1) * (canvas.width / 2 + this.radius)) / this.speedx),
    spacey = Math.abs((this.y - (this.speedy < 0 ? -1 : 1) * (canvas.height / 2 + this.radius)) / this.speedy);
  this.ttl = Math.min(spacex, spacey);
};

Circle.prototype.init = function() {
  Circle.call(this, this.background);
}

//support functions
//generate random int a<=x<=b
function randint(a, b) {
    return Math.floor(Math.random() * (b - a + 1) + a);
  }
  //generate random float
function randRange(a, b) {
    return Math.random() * (b - a) + a;
  }
  //generate random float more likely to be close to a
function hyperRange(a, b) {
  return Math.random() * Math.random() * Math.random() * (b - a) + a;
}

//rendering function
function drawCircle(ctx, circle) {
  //circle.radius *= circleExp;
  var radius = circle.background ? circle.radius *= circleExp : circle.radius /= circleExp;
  ctx.beginPath();
  ctx.arc(circle.x, circle.y, radius * circleExp, 0, 2 * Math.PI, false);
  ctx.lineWidth = Math.max(1, circleBorder * (radMin - circle.radius) / (radMin - radMax));
  ctx.strokeStyle = ['rgba(', circle.borderColor, ',', circle.opacity, ')'].join('');
  if (circle.filled == 'full') {
    ctx.fillStyle = ['rgba(', circle.borderColor, ',', circle.background ? circle.opacity * 0.8 : circle.opacity, ')'].join('');
    ctx.fill();
    ctx.lineWidth=0;
    ctx.strokeStyle = ['rgba(', circle.borderColor, ',', 0, ')'].join('');
  }
  ctx.stroke();
  if (circle.filled == 'concentric') {
    ctx.beginPath();
    ctx.arc(circle.x, circle.y, radius / 2, 0, 2 * Math.PI, false);
    ctx.lineWidth = Math.max(1, circleBorder * (radMin - circle.radius) / (radMin - radMax));
    ctx.strokeStyle = ['rgba(', circle.color, ',', circle.opacity, ')'].join('');
    ctx.stroke();
  }
  circle.x += circle.speedx;
  circle.y += circle.speedy;
  if (circle.opacity < (circle.background ? maxOpacity : 1)) circle.opacity += 0.01;
  circle.ttl--;
}

//initializing function
function init() {
  window.requestAnimationFrame(draw);
}

//rendering function
function draw() {

  if (circlePulse) {
    if (circleExp < circleExpMin || circleExp > circleExpMax) circleExpSp *= -1;
    circleExp += circleExpSp;
  }
  var ctxfr = document.getElementById('canvas').getContext('2d');
  var ctxbg = document.getElementById('canvasbg').getContext('2d');

  ctxfr.globalCompositeOperation = 'destination-over';
  ctxfr.clearRect(0, 0, canvas.width, canvas.height); // clear canvas
  ctxbg.globalCompositeOperation = 'destination-over';
  ctxbg.clearRect(0, 0, canvas.width, canvas.height); // clear canvas

  ctxfr.save();
  ctxfr.translate(canvas.width / 2, canvas.height / 2);
  ctxbg.save();
  ctxbg.translate(canvas.width / 2, canvas.height / 2);

  //function to render each single circle, its connections and to manage its out of boundaries replacement
  function renderPoints(ctx, arr) {
    for (var i = 0; i < arr.length; i++) {
      var circle = arr[i];
      //checking if out of boundaries
      if (circle.ttl<0) {}
      var xEscape = canvas.width / 2 + circle.radius,
        yEscape = canvas.height / 2 + circle.radius;
      if (circle.ttl < -20) arr[i].init(arr[i].background);
      //if (Math.abs(circle.y) > yEscape || Math.abs(circle.x) > xEscape) arr[i].init(arr[i].background);
      drawCircle(ctx, circle);
    }
    for (var i = 0; i < arr.length - 1; i++) {
      for (var j = i + 1; j < arr.length; j++) {
        var deltax = arr[i].x - arr[j].x;
        var deltay = arr[i].y - arr[j].y;
        var dist = Math.pow(Math.pow(deltax, 2) + Math.pow(deltay, 2), 0.5);
        //if the circles are overlapping, no laser connecting them
        if (dist <= arr[i].radius + arr[j].radius) continue;
        //otherwise we connect them only if the dist is < linkDist
        if (dist < linkDist) {
          var xi = (arr[i].x < arr[j].x ? 1 : -1) * Math.abs(arr[i].radius * deltax / dist);
          var yi = (arr[i].y < arr[j].y ? 1 : -1) * Math.abs(arr[i].radius * deltay / dist);
          var xj = (arr[i].x < arr[j].x ? -1 : 1) * Math.abs(arr[j].radius * deltax / dist);
          var yj = (arr[i].y < arr[j].y ? -1 : 1) * Math.abs(arr[j].radius * deltay / dist);
          ctx.beginPath();
          ctx.moveTo(arr[i].x + xi, arr[i].y + yi);
          ctx.lineTo(arr[j].x + xj, arr[j].y + yj);
          var samecolor = arr[i].color == arr[j].color;
          ctx.strokeStyle = ["rgba(", arr[i].borderColor, ",", Math.min(arr[i].opacity, arr[j].opacity) * ((linkDist - dist) / linkDist), ")"].join("");
          ctx.lineWidth = (arr[i].background ? lineBorder * backgroundMlt : lineBorder) * ((linkDist - dist) / linkDist); //*((linkDist-dist)/linkDist);
          ctx.stroke();
        }
      }
    }
  }

  var startTime = Date.now();
  renderPoints(ctxfr, points);
  renderPoints(ctxbg, pointsBack);
  deltaT = Date.now() - startTime;

  ctxfr.restore();
  ctxbg.restore();

  window.requestAnimationFrame(draw);
}

init();

/*Credits and aknowledgements:
Original Idea and Design by Luca Luzzatti

Optimizing tips from Benjamin K?stner
General tips from Salvatore Previti*/</script>
</html>
